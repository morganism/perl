package Ascertain::UM::VFI::Format::DS33;

use Data::Dumper;
use constant TRUE => 1;
use constant FALSE => undef;

use vars qw(@ISA);
our @ISA = qw(Ascertain::UM::VFI::MultiFormat);


#--- !!!!!!!!!!!! Just a hust to be replaced

sub init
{
	my $self = shift;

	$self->{type} = 'fixedwidth'; # csv fixedwidth asn1
	#$self->{has_header} = TRUE;
	#$self->{skip_header_lines} = 1;
	#$self->{header_regex} = qr/^$/;
	$self->{trim_values} = TRUE;
	#$self->{has_trailer} = TRUE;
	#$self->{trailer_regex} = qr/^$/;
  $self->{currency_factor} = 100; # if in euros then 100, if in cents then 1
  $self->{data_factor} = 1; # if in MB then 1048576, if in bytes then 1



	$RT_LOOKUP =
	{
		GSM_MOC_1081    => 'RT_GSM_1081',
		GSM_FORW_1081   => 'RT_GSM_1081',
		GSM_MOC_694     => 'RT_GSM_694',
		GSM_MTC_694     => 'RT_GSM_694',
		GSM_FORW_694    => 'RT_GSM_694',
		GSM_SMSMOC_694  => 'RT_GSM_694',
		GSM_SMSMTC_694  => 'RT_GSM_694',
		ICB_MOC_694     => 'RT_ICB_694',
		ICBV_MOC_694    => 'RT_ICB_694',
		ICBR_MOC_694    => 'RT_ICB_694',
		GSM2_MOC_1184   => 'RT_GSM2_1184',
		GSM2_FORW_1184  => 'RT_GSM2_1184',
		GSM2_MOC_709    => 'RT_GSM2_709',
		GSM2_FORW_709   => 'RT_GSM2_709',
		GSM2_MOC_1156   => 'RT_ICB_SMS_1156',	
		ICB2_MOC_1156   => 'RT_ICB_SMS_1156',
		ICBRR_MOC_1156  => 'RT_ICB_SMS_1156',
		SMS2_MOC_1156   => 'RT_ICB_SMS_1156',
		SMS2_MTC_1156   => 'RT_ICB_SMS_1156',
		CAMEL_MOC_1156  => 'RT_CAMEL_ROAM_USSD_1156',
		CAMEL_FORW_1156 => 'RT_CAMEL_ROAM_USSD_1156',
		ROAM_MTC_1156   => 'RT_CAMEL_ROAM_USSD_1156',
		USSD_MOC_1156   => 'RT_CAMEL_ROAM_USSD_1156',
		GSM_MOC_480     => 'RT_GSM_480',
		GSM_FORW_480    => 'RT_GSM_480',
	};


	#GSM_MOC:1081
	#GSM_FORW:1081
	$RT_GSM_1081 =
	[
		{name=>'RecordType', bytes=>15},
		{name=>'RecordSequenceNumber', bytes=>8},
		{name=>'CallIdentificationNumber', bytes=>8},
		{name=>'CellIDForFirstCellCalling', bytes=>14},
		{name=>'CellIDForLastCellCalling', bytes=>14},
		{name=>'CellIDForFirstCellCalled', bytes=>14},
		{name=>'CellIDForLastCellCalled', bytes=>14},
		{name=>'ChannelRateInfo', bytes=>2},
		{name=>'MSCIdentification', bytes=>25},
		{name=>'CallingSubscriberIMEI', bytes=>16},
		{name=>'CallingSubscriberIMSI', bytes=>15},
		{name=>'CalledSubscriberIMEI', bytes=>16},
		{name=>'CalledSubscriberIMSI', bytes=>15},
		{name=>'RedirectingIMSI', bytes=>15},
		{name=>'TeleServiceCode', bytes=>2},
		{name=>'BearerServiceCode', bytes=>2},
		{name=>'FaultCode', bytes=>5},
		{name=>'CallingPartyNumber', bytes=>25},
		{name=>'CalledPartyNumber', bytes=>25},
		{name=>'OutgoingRoute', bytes=>14},
		{name=>'IncomingRoute', bytes=>14},
		{name=>'ChargedParty', bytes=>2},
		{name=>'DateForStartofCharge', bytes=>8},
		{name=>'TimeForStartofCharge', bytes=>6},
		{name=>'TimeForTCseizureCalling', bytes=>6},
		{name=>'TimeForTCseizureCalled', bytes=>6},
		{name=>'TimeForStopofCharge', bytes=>6},
		{name=>'ChargeableDuration', bytes=>8},
		{name=>'TariffSwitchInd', bytes=>2},
		{name=>'TariffClass', bytes=>4},
		{name=>'InternalCauseAndLoc', bytes=>4},
		{name=>'DisconnectingParty', bytes=>2},
		{name=>'INMarkingOfMS', bytes=>2},
		{name=>'RelatedCallNumber', bytes=>25},
		{name=>'RedirectionCounter', bytes=>4},
		{name=>'RedirectingNumber', bytes=>25},
		{name=>'OriginalCalledNumber', bytes=>25},
		{name=>'MobileStationRoamingNum', bytes=>25},
		{name=>'ServiceCentreAddress', bytes=>25},
		{name=>'TAC', bytes=>8},
		{name=>'PartialOutputRecNum', bytes=>2},
		{name=>'LastPartialOutput', bytes=>1},
		{name=>'INTrafficCase', bytes=>4},
		{name=>'INServiceClassKey', bytes=>6},
		{name=>'INAccountValueBeforeCall', bytes=>14},
		{name=>'INAccountValueAfterCall', bytes=>14},
		{name=>'INFinalChargeOfCall', bytes=>14},
		{name=>'INFinalChargeableDuration', bytes=>6},
		{name=>'INCDRType', bytes=>6},
		{name=>'DA_Account_ID_1', bytes=>2},
		{name=>'DA_Campaign_Identifier_1', bytes=>8},
		{name=>'DA_dur_of_DA_event_1', bytes=>10},
		{name=>'DA_balance_before_1', bytes=>14},
		{name=>'DA_balance_before_currency_1', bytes=>1},
		{name=>'DA_balance_after_1', bytes=>14},
		{name=>'DA_balance_after_currency_1', bytes=>1},
		{name=>'DA_Account_ID_2', bytes=>2},
		{name=>'DA_Campaign_Identifier_2', bytes=>8},
		{name=>'DA_dur_of_DA_event_2', bytes=>10},
		{name=>'DA_balance_before_2', bytes=>14},
		{name=>'DA_balance_before_currency_2', bytes=>1},
		{name=>'DA_balance_after_2', bytes=>14},
		{name=>'DA_balance_after_currency_2', bytes=>1},
		{name=>'DA_Account_ID_3', bytes=>2},
		{name=>'DA_Campaign_Identifier_3', bytes=>8},
		{name=>'DA_dur_of_DA_event_3', bytes=>10},
		{name=>'DA_balance_before_3', bytes=>14},
		{name=>'DA_balance_before_currency_3', bytes=>1},
		{name=>'DA_balance_after_3', bytes=>14},
		{name=>'DA_balance_after_currency_3', bytes=>1},
		{name=>'DA_Account_ID_4', bytes=>2},
		{name=>'DA_Campaign_Identifier_4', bytes=>8},
		{name=>'DA_dur_of_DA_event_4', bytes=>10},
		{name=>'DA_balance_before_4', bytes=>14},
		{name=>'DA_balance_before_currency_4', bytes=>1},
		{name=>'DA_balance_after_4', bytes=>14},
		{name=>'DA_balance_after_currency_4', bytes=>1},
		{name=>'DA_Account_ID_5', bytes=>2},
		{name=>'DA_Campaign_Identifier_5', bytes=>8},
		{name=>'DA_dur_of_DA_event_5', bytes=>10},
		{name=>'DA_balance_before_5', bytes=>14},
		{name=>'DA_balance_before_currency_5', bytes=>1},
		{name=>'DA_balance_after_5', bytes=>14},
		{name=>'DA_balance_after_currency_5', bytes=>1},
		{name=>'INAccountGroup', bytes=>10},
		{name=>'INCalledPartyNumber', bytes=>25},
		{name=>'INCalledPartyNumber2', bytes=>25},
		{name=>'INCalledPartyNumber3', bytes=>25},
		{name=>'INCallingPartyNumber', bytes=>25},
		{name=>'INCommunityGroupData1', bytes=>21},
		{name=>'INCommunityGroupData2', bytes=>21},
		{name=>'INOriginatingLocationIndicator', bytes=>25},
		{name=>'INRedirectingNumber', bytes=>25},
		{name=>'INServiceOfferings', bytes=>10},
		{name=>'INSubscriberNumber', bytes=>25},
		{name=>'INTerminatingLocationIndicator', bytes=>25},
		{name=>'INAccountNumber', bytes=>25},
		{name=>'ServiceID', bytes=>6},
	];
	#GSM_MOC:694
	#GSM_MTC:694
	#GSM_FORW:694
	#GSM_SMSMOC:694
	#GSM_SMSMTC:694
	$RT_GSM_694 =
	[
		{name=>'RecordType', bytes=>15},
		{name=>'RecordSequenceNumber', bytes=>8},
		{name=>'CallIdentificationNumber', bytes=>8},
		{name=>'CellIDForFirstCellCalling', bytes=>14},
		{name=>'CellIDForLastCellCalling', bytes=>14},
		{name=>'CellIDForFirstCellCalled', bytes=>14},
		{name=>'CellIDForLastCellCalled', bytes=>14},
		{name=>'ChannelRateInfo', bytes=>2},
		{name=>'MSCIdentification', bytes=>25},
		{name=>'CallingSubscriberIMEI', bytes=>16},
		{name=>'CallingSubscriberIMSI', bytes=>15},
		{name=>'CalledSubscriberIMEI', bytes=>16},
		{name=>'CalledSubscriberIMSI', bytes=>15},
		{name=>'RedirectingIMSI', bytes=>15},
		{name=>'TeleServiceCode', bytes=>2},
		{name=>'BearerServiceCode', bytes=>2},
		{name=>'FaultCode', bytes=>5},
		{name=>'CallingPartyNumber', bytes=>25},
		{name=>'CalledPartyNumber', bytes=>25},
		{name=>'OutgoingRoute', bytes=>14},
		{name=>'IncomingRoute', bytes=>14},
		{name=>'ChargedParty', bytes=>2},
		{name=>'DateForStartofCharge', bytes=>8},
		{name=>'TimeForStartofCharge', bytes=>6},
		{name=>'TimeForTCseizureCalling', bytes=>6},
		{name=>'TimeForTCseizureCalled', bytes=>6},
		{name=>'TimeForStopofCharge', bytes=>6},
		{name=>'ChargeableDuration', bytes=>8},
		{name=>'TariffSwitchInd', bytes=>2},
		{name=>'TariffClass', bytes=>4},
		{name=>'InternalCauseAndLoc', bytes=>4},
		{name=>'DisconnectingParty', bytes=>2},
		{name=>'INMarkingOfMS', bytes=>2},
		{name=>'RelatedCallNumber', bytes=>25},
		{name=>'RedirectionCounter', bytes=>4},
		{name=>'RedirectingNumber', bytes=>25},
		{name=>'OriginalCalledNumber', bytes=>25},
		{name=>'MobileStationRoamingNum', bytes=>25},
		{name=>'ServiceCentreAddress', bytes=>25},
		{name=>'TAC', bytes=>8},
		{name=>'PartialOutputRecNum', bytes=>2},
		{name=>'LastPartialOutput', bytes=>1},
		{name=>'VPNServiceCode', bytes=>4},
		{name=>'VPNTypeofAccess', bytes=>4},
		{name=>'VPNCallType', bytes=>4},
		{name=>'VPNSrvcSubscbrId', bytes=>6},
		{name=>'VPNReqstdBerCapblties', bytes=>4},
		{name=>'VPNPublicNumCallingParty', bytes=>16},
		{name=>'VPNPrivateNumCallingParty', bytes=>14},
		{name=>'VPNPublicNumCalledParty', bytes=>16},
		{name=>'VPNDialledNumber', bytes=>26},
		{name=>'INSDataChargePartySingle', bytes=>2},
		{name=>'INSDataTimeForEvent', bytes=>6},
		{name=>'RCP0Hits', bytes=>8},
		{name=>'RCP0Duration', bytes=>8},
		{name=>'RCP1Hits', bytes=>8},
		{name=>'RCP1Duration', bytes=>8},
		{name=>'RCP2Hits', bytes=>8},
		{name=>'RCP2Duration', bytes=>8},
		{name=>'RCP3Hits', bytes=>8},
		{name=>'RCP3Duration', bytes=>8},
		{name=>'RCP4Hits', bytes=>8},
		{name=>'RCP4Duration', bytes=>8},
		{name=>'RCP5Hits', bytes=>8},
		{name=>'RCP5Duration', bytes=>8},
		{name=>'RCP6Hits', bytes=>8},
		{name=>'RCP6Duration', bytes=>8},
		{name=>'ServiceID', bytes=>6},
	];
	#ICB_MOC:694
	#ICBV_MOC:694
	#ICBR_MOC:694
	$RT_ICB_694 =
	[
		{name=>'RecordType', bytes=>15},
		{name=>'RecordSequenceNumber', bytes=>8},
		{name=>'CallIdentificationNumber', bytes=>8},
		{name=>'CellIDForFirstCellCalling', bytes=>14},
		{name=>'CellIDForLastCellCalling', bytes=>14},
		{name=>'CellIDForFirstCellCalled', bytes=>14},
		{name=>'CellIDForLastCellCalled', bytes=>14},
		{name=>'ChannelRateInfo', bytes=>2},
		{name=>'MSCIdentification', bytes=>25},
		{name=>'CallingSubscriberIMEI', bytes=>16},
		{name=>'CallingSubscriberIMSI', bytes=>15},
		{name=>'CalledSubscriberIMEI', bytes=>16},
		{name=>'CalledSubscriberIMSI', bytes=>15},
		{name=>'RedirectingIMSI', bytes=>15},
		{name=>'TeleServiceCode', bytes=>2},
		{name=>'BearerServiceCode', bytes=>2},
		{name=>'FaultCode', bytes=>5},
		{name=>'CallingPartyNumber', bytes=>25},
		{name=>'CalledPartyNumber', bytes=>25},
		{name=>'OutgoingRoute', bytes=>14},
		{name=>'IncomingRoute', bytes=>14},
		{name=>'ChargedParty', bytes=>2},
		{name=>'DateForStartofCharge', bytes=>8},
		{name=>'TimeForStartofCharge', bytes=>6},
		{name=>'TimeForTCseizureCalling', bytes=>6},
		{name=>'TimeForTCseizureCalled', bytes=>6},
		{name=>'TimeForStopofCharge', bytes=>6},
		{name=>'ChargeableDuration', bytes=>8},
		{name=>'TariffSwitchInd', bytes=>2},
		{name=>'TariffClass', bytes=>4},
		{name=>'InternalCauseAndLoc', bytes=>4},
		{name=>'DisconnectingParty', bytes=>2},
		{name=>'INMarkingOfMS', bytes=>2},
		{name=>'RelatedCallNumber', bytes=>25},
		{name=>'RedirectionCounter', bytes=>4},
		{name=>'RedirectingNumber', bytes=>25},
		{name=>'OriginalCalledNumber', bytes=>25},
		{name=>'MobileStationRoamingNum', bytes=>25},
		{name=>'ServiceCentreAddress', bytes=>25},
		{name=>'TAC', bytes=>8},
		{name=>'PartialOutputRecNum', bytes=>2},
		{name=>'LastPartialOutput', bytes=>1},
		{name=>'VPNServiceCode', bytes=>4},
		{name=>'VPNTypeofAccess', bytes=>4},
		{name=>'VPNCallType', bytes=>4},
		{name=>'VPNSrvcSubscbrId', bytes=>6},
		{name=>'VPNReqstdBerCapblties', bytes=>4},
		{name=>'VPNDialledNumber', bytes=>16},
		{name=>'VPNPublicNumCallingParty', bytes=>14},
		{name=>'VPNPrivateNumCallingParty', bytes=>16},
		{name=>'VPNPublicNumCalledParty', bytes=>26},
		{name=>'INSDataChargePartySingle', bytes=>2},
		{name=>'INSDataTimeForEvent', bytes=>6},
		{name=>'RCP0Hits', bytes=>8},
		{name=>'RCP0Duration', bytes=>8},
		{name=>'RCP1Hits', bytes=>8},
		{name=>'RCP1Duration', bytes=>8},
		{name=>'RCP2Hits', bytes=>8},
		{name=>'RCP2Duration', bytes=>8},
		{name=>'RCP3Hits', bytes=>8},
		{name=>'RCP3Duration', bytes=>8},
		{name=>'RCP4Hits', bytes=>8},
		{name=>'RCP4Duration', bytes=>8},
		{name=>'RCP5Hits', bytes=>8},
		{name=>'RCP5Duration', bytes=>8},
		{name=>'RCP6Hits', bytes=>8},
		{name=>'RCP6Duration', bytes=>8},
		{name=>'ServiceID', bytes=>6},
	];


	#GSM2_MOC:1184
	#GSM2_FORW:1184

	$RT_GSM2_1184 =
	[
		{name=>'RecordType', bytes=>15},
		{name=>'RecordSequenceNumber', bytes=>8},
		{name=>'CallIdentificationNumber', bytes=>8},
		{name=>'CellIDForFirstCellCalling', bytes=>14},
		{name=>'CellIDForLastCellCalling', bytes=>14},
		{name=>'CellIDForFirstCellCalled', bytes=>14},
		{name=>'CellIDForLastCellCalled', bytes=>14},
		{name=>'ChannelRateInfo', bytes=>2},
		{name=>'MSCIdentification', bytes=>25},
		{name=>'CallingSubscriberIMEI', bytes=>16},
		{name=>'CallingSubscriberIMSI', bytes=>15},
		{name=>'CalledSubscriberIMEI', bytes=>16},
		{name=>'CalledSubscriberIMSI', bytes=>15},
		{name=>'RedirectingIMSI', bytes=>15},
		{name=>'TeleServiceCode', bytes=>2},
		{name=>'BearerServiceCode', bytes=>2},
		{name=>'FaultCode', bytes=>5},
		{name=>'CallingPartyNumber', bytes=>25},
		{name=>'CalledPartyNumber', bytes=>25},
		{name=>'OutgoingRoute', bytes=>14},
		{name=>'IncomingRoute', bytes=>14},
		{name=>'ChargedParty', bytes=>2},
		{name=>'DateForStartofCharge', bytes=>8},
		{name=>'TimeForStartofCharge', bytes=>6},
		{name=>'TimeForTCseizureCalling', bytes=>6},
		{name=>'TimeForTCseizureCalled', bytes=>6},
		{name=>'TimeForStopofCharge', bytes=>6},
		{name=>'ChargeableDuration', bytes=>8},
		{name=>'TariffSwitchInd', bytes=>2},
		{name=>'TariffClass', bytes=>4},
		{name=>'InternalCauseAndLoc', bytes=>4},
		{name=>'DisconnectingParty', bytes=>2},
		{name=>'INMarkingOfMS', bytes=>2},
		{name=>'RelatedCallNumber', bytes=>25},
		{name=>'RedirectionCounter', bytes=>4},
		{name=>'RedirectingNumber', bytes=>25},
		{name=>'OriginalCalledNumber', bytes=>25},
		{name=>'MobileStationRoamingNum', bytes=>25},
		{name=>'ServiceCentreAddress', bytes=>25},
		{name=>'TAC', bytes=>8},
		{name=>'PartialOutputRecNum', bytes=>2},
		{name=>'LastPartialOutput', bytes=>1},
		{name=>'INTrafficCase', bytes=>4},
		{name=>'INServiceClassKey', bytes=>6},
		{name=>'INCurrencyIndicatorVBC', bytes=>1},
		{name=>'INAccountValueBeforeCall', bytes=>14},
		{name=>'INCurrencyIndicatorVAC', bytes=>1},
		{name=>'INAccountValueAfterCall', bytes=>14},
		{name=>'INCurrencyIndicatorFCC', bytes=>1},
		{name=>'INFinalChargeOfCall', bytes=>14},
		{name=>'INFinalChargeableDuration', bytes=>6},
		{name=>'INFamilyFriendsIndicator', bytes=>6},
		{name=>'VLR', bytes=>28},
		{name=>'INCDRType', bytes=>6},
		{name=>'DA_Account_ID_1', bytes=>2},
		{name=>'DA_Campaign_Identifier_1', bytes=>8},
		{name=>'DA_dur_of_DA_event_1', bytes=>10},
		{name=>'DA_balance_before_1', bytes=>14},
		{name=>'DA_balance_before_currency_1', bytes=>1},
		{name=>'DA_balance_after_1', bytes=>14},
		{name=>'DA_balance_after_currency_1', bytes=>1},
		{name=>'DA_Account_ID_2', bytes=>2},
		{name=>'DA_Campaign_Identifier_2', bytes=>8},
		{name=>'DA_dur_of_DA_event_2', bytes=>10},
		{name=>'DA_balance_before_2', bytes=>14},
		{name=>'DA_balance_before_currency_2', bytes=>1},
		{name=>'DA_balance_after_2', bytes=>14},
		{name=>'DA_balance_after_currency_2', bytes=>1},
		{name=>'DA_Account_ID_3', bytes=>2},
		{name=>'DA_Campaign_Identifier_3', bytes=>8},
		{name=>'DA_dur_of_DA_event_3', bytes=>10},
		{name=>'DA_balance_before_3', bytes=>14},
		{name=>'DA_balance_before_currency_3', bytes=>1},
		{name=>'DA_balance_after_3', bytes=>14},
		{name=>'DA_balance_after_currency_3', bytes=>1},
		{name=>'DA_Account_ID_4', bytes=>2},
		{name=>'DA_Campaign_Identifier_4', bytes=>8},
		{name=>'DA_dur_of_DA_event_4', bytes=>10},
		{name=>'DA_balance_before_4', bytes=>14},
		{name=>'DA_balance_before_curreny_4', bytes=>1},
		{name=>'DA_balance_after_4', bytes=>14},
		{name=>'DA_balance_after_currency_4', bytes=>1},
		{name=>'DA_Account_ID_5', bytes=>2},
		{name=>'DA_Campaign_Identifier_5', bytes=>8},
		{name=>'DA_dur_of_DA_event_5', bytes=>10},
		{name=>'DA_balance_before_5', bytes=>14},
		{name=>'DA_balance_before_currenc', bytes=>1},
		{name=>'DA_balance_after_5', bytes=>14},
		{name=>'DA_balance_after_currency_5', bytes=>1},
		{name=>'INAccountGroup', bytes=>10},
		{name=>'INCalledPartyNumber', bytes=>25},
		{name=>'INCalledPartyNumber2', bytes=>25},
		{name=>'INCalledPartyNumber3', bytes=>25},
		{name=>'INCallingPartyNumber', bytes=>25},
		{name=>'INCommunityGroupData1', bytes=>21},
		{name=>'INCommunityGroupData2', bytes=>21},
		{name=>'INOriginatingLocationIndicator', bytes=>25},
		{name=>'INRedirectingNumber', bytes=>25},
		{name=>'INServiceOfferings', bytes=>10},
		{name=>'INSubscriberNumber', bytes=>25},
		{name=>'INTerminatingLocationIndicator', bytes=>25},
		{name=>'INAccountNumber', bytes=>25},
		{name=>'Acc_value_Accumulator_1', bytes=>10},
		{name=>'Acc_value_Accumulator_2', bytes=>10},
		{name=>'Acc_value_Accumulator_3', bytes=>10},
		{name=>'Acc_value_Accumulator_4', bytes=>10},
		{name=>'Acc_value_Accumulator_5', bytes=>10},
		{name=>'Acc_identifier', bytes=>1},
		{name=>'Acc_Valid_1', bytes=>1},
		{name=>'Acc_Valid_2', bytes=>1},
		{name=>'Acc_Valid_3', bytes=>1},
		{name=>'Acc_Valid_4', bytes=>1},
		{name=>'Acc_Valid_5', bytes=>1},
		{name=>'Acc_delta_value', bytes=>10},
		{name=>'ServiceID', bytes=>6},
	];

	#GSM2_MOC:709
	#GSM2_FORW:709
	$RT_GSM2_709 =
	[
		{name=>'RecordType', bytes=>15},
		{name=>'RecordSequenceNumber', bytes=>8},
		{name=>'CallIdentificationNumber', bytes=>8},
		{name=>'CellIDForFirstCellCalling', bytes=>14},
		{name=>'CellIDForLastCellCalling', bytes=>14},
		{name=>'CellIDForFirstCellCalled', bytes=>14},
		{name=>'CellIDForLastCellCalled', bytes=>14},
		{name=>'ChannelRateInfo', bytes=>2},
		{name=>'MSCIdentification', bytes=>25},
		{name=>'CallingSubscriberIMEI', bytes=>16},
		{name=>'CallingSubscriberIMSI', bytes=>15},
		{name=>'CalledSubscriberIMEI', bytes=>16},
		{name=>'CalledSubscriberIMSI', bytes=>15},
		{name=>'RedirectingIMSI', bytes=>15},
		{name=>'TeleServiceCode', bytes=>2},
		{name=>'BearerServiceCode', bytes=>2},
		{name=>'FaultCode', bytes=>5},
		{name=>'CallingPartyNumber', bytes=>25},
		{name=>'CalledPartyNumber', bytes=>25},
		{name=>'OutgoingRoute', bytes=>14},
		{name=>'IncomingRoute', bytes=>14},
		{name=>'ChargedParty', bytes=>2},
		{name=>'DateForStartofCharge', bytes=>8},
		{name=>'TimeForStartofCharge', bytes=>6},
		{name=>'TimeForTCseizureCalling', bytes=>6},
		{name=>'TimeForTCseizureCalled', bytes=>6},
		{name=>'TimeForStopofCharge', bytes=>6},
		{name=>'ChargeableDuration', bytes=>8},
		{name=>'TariffSwitchInd', bytes=>2},
		{name=>'TariffClass', bytes=>4},
		{name=>'InternalCauseAndLoc', bytes=>4},
		{name=>'DisconnectingParty', bytes=>2},
		{name=>'INMarkingOfMS', bytes=>2},
		{name=>'RelatedCallNumber', bytes=>25},
		{name=>'RedirectionCounter', bytes=>4},
		{name=>'RedirectingNumber', bytes=>25},
		{name=>'OriginalCalledNumber', bytes=>25},
		{name=>'MobileStationRoamingNum', bytes=>25},
		{name=>'ServiceCentreAddress', bytes=>25},
		{name=>'TAC', bytes=>8},
		{name=>'PartialOutputRecNum', bytes=>2},
		{name=>'LastPartialOutput', bytes=>1},
		{name=>'VPNServiceCode', bytes=>4},
		{name=>'VPNTypeofAccess', bytes=>4},
		{name=>'VPNSrvcSubscbrId', bytes=>6},
		{name=>'VPNCallType', bytes=>4},
		{name=>'VPNReqstdBerCapblties', bytes=>4},
		{name=>'MSRN', bytes=>15},
		{name=>'VPNDialledNumber', bytes=>26},
		{name=>'VPNPublicNumCallingParty', bytes=>16},
		{name=>'VPNPrivateNumCallingParty', bytes=>14},
		{name=>'VPNPublicNumCalledParty', bytes=>16},
		{name=>'INSDataChargePartySingle', bytes=>2},
		{name=>'INSDataTimeForEvent', bytes=>6},
		{name=>'RCP0Hits', bytes=>8},
		{name=>'RCP0Duration', bytes=>8},
		{name=>'RCP1Hits', bytes=>8},
		{name=>'RCP1Duration', bytes=>8},
		{name=>'RCP2Hits', bytes=>8},
		{name=>'RCP2Duration', bytes=>8},
		{name=>'RCP3Hits', bytes=>8},
		{name=>'RCP3Duration', bytes=>8},
		{name=>'RCP4Hits', bytes=>8},
		{name=>'RCP4Duration', bytes=>8},
		{name=>'RCP5Hits', bytes=>8},
		{name=>'RCP5Duration', bytes=>8},
		{name=>'RCP6Hits', bytes=>8},
		{name=>'RCP6Duration', bytes=>8},
		{name=>'ServiceID', bytes=>6},
	];

	#ICB2_MOC:1156
	#ICBRR_MOC:1156
	#SMS2_MOC:1156
	#SMS2_MTC:1156
	$RT_ICB_SMS_1156 =
	[
		{name=>'RecordType', bytes=>15},
		{name=>'RecordSequenceNumber', bytes=>8},
		{name=>'CallIdentificationNumber', bytes=>8},
		{name=>'CellIDForFirstCellCalling', bytes=>14},
		{name=>'CellIDForLastCellCalling', bytes=>14},
		{name=>'CellIDForFirstCellCalled', bytes=>14},
		{name=>'CellIDForLastCellCalled', bytes=>14},
		{name=>'ChannelRateInfo', bytes=>2},
		{name=>'MSCIdentification', bytes=>25},
		{name=>'CallingSubscriberIMEI', bytes=>16},
		{name=>'CallingSubscriberIMSI', bytes=>15},
		{name=>'CalledSubscriberIMEI', bytes=>16},
		{name=>'CalledSubscriberIMSI', bytes=>15},
		{name=>'RedirectingIMSI', bytes=>15},
		{name=>'TeleServiceCode', bytes=>2},
		{name=>'BearerServiceCode', bytes=>2},
		{name=>'FaultCode', bytes=>5},
		{name=>'CallingPartyNumber', bytes=>25},
		{name=>'CalledPartyNumber', bytes=>25},
		{name=>'OutgoingRoute', bytes=>14},
		{name=>'IncomingRoute', bytes=>14},
		{name=>'ChargedParty', bytes=>2},
		{name=>'DateForStartofCharge', bytes=>8},
		{name=>'TimeForStartofCharge', bytes=>6},
		{name=>'TimeForTCseizureCalling', bytes=>6},
		{name=>'TimeForTCseizureCalled', bytes=>6},
		{name=>'TimeForStopofCharge', bytes=>6},
		{name=>'ChargeableDuration', bytes=>8},
		{name=>'TariffSwitchInd', bytes=>2},
		{name=>'TariffClass', bytes=>4},
		{name=>'InternalCauseAndLoc', bytes=>4},
		{name=>'DisconnectingParty', bytes=>2},
		{name=>'INMarkingOfMS', bytes=>2},
		{name=>'RelatedCallNumber', bytes=>25},
		{name=>'RedirectionCounter', bytes=>4},
		{name=>'RedirectingNumber', bytes=>25},
		{name=>'OriginalCalledNumber', bytes=>25},
		{name=>'MobileStationRoamingNum', bytes=>25},
		{name=>'ServiceCentreAddress', bytes=>25},
		{name=>'TAC', bytes=>8},
		{name=>'PartialOutputRecNum', bytes=>2},
		{name=>'LastPartialOutput', bytes=>1},
		{name=>'INTrafficCase', bytes=>4},
		{name=>'INServiceClassKey', bytes=>6},
		{name=>'INCurrencyIndicatorVBC', bytes=>1},
		{name=>'INAccountValueBeforeCall', bytes=>14},
		{name=>'INCurrencyIndicatorVAC', bytes=>1},
		{name=>'INAccountValueAfterCall', bytes=>14},
		{name=>'INCurrencyIndicatorFCC', bytes=>1},
		{name=>'INFinalChargeOfCall', bytes=>14},
		{name=>'INFinalChargeableDuration', bytes=>6},
		{name=>'INFamilyFriendsIndicator', bytes=>6},
		{name=>'INCDRType', bytes=>6},
		{name=>'DA_Account_ID_1', bytes=>2},
		{name=>'DA_Campaign_Identifier_1', bytes=>8},
		{name=>'DA_dur_of_DA_event_1', bytes=>10},
		{name=>'DA_balance_before_1', bytes=>14},
		{name=>'DA_balance_before_currency_1', bytes=>1},
		{name=>'DA_balance_after_1', bytes=>14},
		{name=>'DA_balance_after_currency_1', bytes=>1},
		{name=>'DA_Account_ID_2', bytes=>2},
		{name=>'DA_Campaign_Identifier_2', bytes=>8},
		{name=>'DA_dur_of_DA_event_2', bytes=>10},
		{name=>'DA_balance_before_2', bytes=>14},
		{name=>'DA_balance_before_currency_2', bytes=>1},
		{name=>'DA_balance_after_2', bytes=>14},
		{name=>'DA_balance_after_currency_2', bytes=>1},
		{name=>'DA_Account_ID_3', bytes=>2},
		{name=>'DA_Campaign_Identifier_3', bytes=>8},
		{name=>'DA_dur_of_DA_event_3', bytes=>10},
		{name=>'DA_balance_before_3', bytes=>14},
		{name=>'DA_balance_before_currency_3', bytes=>1},
		{name=>'DA_balance_after_3', bytes=>14},
		{name=>'DA_balance_after_currency_3', bytes=>1},
		{name=>'DA_Account_ID_4', bytes=>2},
		{name=>'DA_Campaign_Identifier_4', bytes=>8},
		{name=>'DA_dur_of_DA_event_4', bytes=>10},
		{name=>'DA_balance_before_4', bytes=>14},
		{name=>'DA_balance_before_currency_4', bytes=>1},
		{name=>'DA_balance_after_4', bytes=>14},
		{name=>'DA_balance_after_currency_4', bytes=>1},
		{name=>'DA_Account_ID_5', bytes=>2},
		{name=>'DA_Campaign_Identifier_5', bytes=>8},
		{name=>'DA_dur_of_DA_event_5', bytes=>10},
		{name=>'DA_balance_before_5', bytes=>14},
		{name=>'DA_balance_before_currency_5', bytes=>1},
		{name=>'DA_balance_after_5', bytes=>14},
		{name=>'DA_balance_after_currency_5', bytes=>1},
		{name=>'INAccountGroup', bytes=>10},
		{name=>'INCalledPartyNumber', bytes=>25},
		{name=>'INCalledPartyNumber2', bytes=>25},
		{name=>'INCalledPartyNumber3', bytes=>25},
		{name=>'INCallingPartyNumber', bytes=>25},
		{name=>'INCommunityGroupData1', bytes=>21},
		{name=>'INCommunityGroupData2', bytes=>21},
		{name=>'INOriginatingLocationIndicator', bytes=>25},
		{name=>'INRedirectingNumber', bytes=>25},
		{name=>'INServiceOfferings', bytes=>10},
		{name=>'INSubscriberNumber', bytes=>25},
		{name=>'INTerminatingLocationIndicator', bytes=>25},
		{name=>'INAccountNumber', bytes=>25},
		{name=>'Acc_value_Accumulator_1', bytes=>10},
		{name=>'Acc_value_Accumulator_2', bytes=>10},
		{name=>'Acc_value_Accumulator_3', bytes=>10},
		{name=>'Acc_value_Accumulator_4', bytes=>10},
		{name=>'Acc_value_Accumulator_5', bytes=>10},
		{name=>'Acc_identifier', bytes=>1},
		{name=>'Acc_Valid_1', bytes=>1},
		{name=>'Acc_Valid_2', bytes=>1},
		{name=>'Acc_Valid_3', bytes=>1},
		{name=>'Acc_Valid_4', bytes=>1},
		{name=>'Acc_Valid_5', bytes=>1},
		{name=>'Acc_delta_value', bytes=>10},
		{name=>'ServiceID', bytes=>6},
	];

	#CAMEL_MOC:1156
	#CAMEL_FORW:1156
	#ROAM_MTC:1156
	#USSD_MOC:1156
	$RT_CAMEL_ROAM_USSD_1156 =
	[
		{name=>'RecordType', bytes=>15},
		{name=>'RecordSequenceNumber', bytes=>8},
		{name=>'CallIdentificationNumber', bytes=>8},
		{name=>'CellIDForFirstCellCalling', bytes=>14},
		{name=>'CellIDForLastCellCalling', bytes=>14},
		{name=>'CellIDForFirstCellCalled', bytes=>14},
		{name=>'CellIDForLastCellCalled', bytes=>14},
		{name=>'ChannelRateInfo', bytes=>2},
		{name=>'MSCIdentification', bytes=>25},
		{name=>'CallingSubscriberIMEI', bytes=>16},
		{name=>'CallingSubscriberIMSI', bytes=>15},
		{name=>'CalledSubscriberIMEI', bytes=>16},
		{name=>'CalledSubscriberIMSI', bytes=>15},
		{name=>'RedirectingIMSI', bytes=>15},
		{name=>'TeleServiceCode', bytes=>2},
		{name=>'BearerServiceCode', bytes=>2},
		{name=>'FaultCode', bytes=>5},
		{name=>'CallingPartyNumber', bytes=>25},
		{name=>'CalledPartyNumber', bytes=>25},
		{name=>'OutgoingRoute', bytes=>14},
		{name=>'IncomingRoute', bytes=>14},
		{name=>'ChargedParty', bytes=>2},
		{name=>'DateForStartofCharge', bytes=>8},
		{name=>'TimeForStartofCharge', bytes=>6},
		{name=>'TimeForTCseizureCalling', bytes=>6},
		{name=>'TimeForTCseizureCalled', bytes=>6},
		{name=>'TimeForStopofCharge', bytes=>6},
		{name=>'ChargeableDuration', bytes=>8},
		{name=>'TariffSwitchInd', bytes=>2},
		{name=>'TariffClass', bytes=>4},
		{name=>'InternalCauseAndLoc', bytes=>4},
		{name=>'DisconnectingParty', bytes=>2},
		{name=>'INMarkingOfMS', bytes=>2},
		{name=>'RelatedCallNumber', bytes=>25},
		{name=>'RedirectionCounter', bytes=>4},
		{name=>'RedirectingNumber', bytes=>25},
		{name=>'OriginalCalledNumber', bytes=>25},
		{name=>'MobileStationRoamingNum', bytes=>25},
		{name=>'ServiceCentreAddress', bytes=>25},
		{name=>'TAC', bytes=>8},
		{name=>'PartialOutputRecNum', bytes=>2},
		{name=>'LastPartialOutput', bytes=>1},
		{name=>'INTrafficCase', bytes=>4},
		{name=>'INServiceClassKey', bytes=>6},
		{name=>'INCurrencyIndicatorVBC', bytes=>1},
		{name=>'INAccountValueBeforeCall', bytes=>14},
		{name=>'INCurrencyIndicatorVAC', bytes=>1},
		{name=>'INAccountValueAfterCall', bytes=>14},
		{name=>'INCurrencyIndicatorFCC', bytes=>1},
		{name=>'INFinalChargeOfCall', bytes=>14},
		{name=>'INFinalChargeableDuration', bytes=>6},
		{name=>'INFamilyFriendsIndicator', bytes=>6},
		{name=>'INCDRType', bytes=>6},
		{name=>'DA_Account_ID_1', bytes=>2},
		{name=>'DA_Campaign_Identifier_1', bytes=>8},
		{name=>'DA_dur_of_DA_event_1', bytes=>10},
		{name=>'DA_balance_before_1', bytes=>14},
		{name=>'DA_balance_before_currency_1', bytes=>1},
		{name=>'DA_balance_after_1', bytes=>14},
		{name=>'DA_balance_after_currency_1', bytes=>1},
		{name=>'DA_Account_ID_2', bytes=>2},
		{name=>'DA_Campaign_Identifier_2', bytes=>8},
		{name=>'DA_dur_of_DA_event_2', bytes=>10},
		{name=>'DA_balance_before_2', bytes=>14},
		{name=>'DA_balance_before_currency_2', bytes=>1},
		{name=>'DA_balance_after_2', bytes=>14},
		{name=>'DA_balance_after_currency_2', bytes=>1},
		{name=>'DA_Account_ID_3', bytes=>2},
		{name=>'DA_Campaign_Identifier_3', bytes=>8},
		{name=>'DA_dur_of_DA_event_3', bytes=>10},
		{name=>'DA_balance_before_3', bytes=>14},
		{name=>'DA_balance_before_currency_3', bytes=>1},
		{name=>'DA_balance_after_3', bytes=>14},
		{name=>'DA_balance_after_currency_3', bytes=>1},
		{name=>'DA_Account_ID_4', bytes=>2},
		{name=>'DA_Campaign_Identifier_4', bytes=>8},
		{name=>'DA_dur_of_DA_event_4', bytes=>10},
		{name=>'DA_balance_before_4', bytes=>14},
		{name=>'DA_balance_before_currency_4', bytes=>1},
		{name=>'DA_balance_after_4', bytes=>14},
		{name=>'DA_balance_after_currency_4', bytes=>1},
		{name=>'DA_Account_ID_5', bytes=>2},
		{name=>'DA_Campaign_Identifier_5', bytes=>8},
		{name=>'DA_dur_of_DA_event_5', bytes=>10},
		{name=>'DA_balance_before_5', bytes=>14},
		{name=>'DA_balance_before_currency_5', bytes=>1},
		{name=>'DA_balance_after_5', bytes=>14},
		{name=>'DA_balance_after_currency_5', bytes=>1},
		{name=>'INAccountGroup', bytes=>10},
		{name=>'INCalledPartyNumber', bytes=>25},
		{name=>'INCalledPartyNumber2', bytes=>25},
		{name=>'INCalledPartyNumber3', bytes=>25},
		{name=>'INCallingPartyNumber', bytes=>25},
		{name=>'INCommunityGroupData1', bytes=>21},
		{name=>'INCommunityGroupData2', bytes=>21},
		{name=>'INOriginatingLocationIndicator', bytes=>25},
		{name=>'INRedirectingNumber', bytes=>25},
		{name=>'INServiceOfferings', bytes=>10},
		{name=>'INSubscriberNumber', bytes=>25},
		{name=>'INTerminatingLocationIndicator', bytes=>25},
		{name=>'INAccountNumber', bytes=>25},
		{name=>'Acc_value_Accumulator_1', bytes=>10},
		{name=>'Acc_value_Accumulator_2', bytes=>10},
		{name=>'Acc_value_Accumulator_3', bytes=>10},
		{name=>'Acc_value_Accumulator_4', bytes=>10},
		{name=>'Acc_value_Accumulator_5', bytes=>10},
		{name=>'Acc_identifier', bytes=>1},
		{name=>'Acc_Valid_1', bytes=>1},
		{name=>'Acc_Valid_2', bytes=>1},
		{name=>'Acc_Valid_3', bytes=>1},
		{name=>'Acc_Valid_4', bytes=>1},
		{name=>'Acc_Valid_5', bytes=>1},
		{name=>'Acc_delta_value', bytes=>10},
		{name=>'ServiceID', bytes=>6},
	];

	#GSM_MOC:480
	#GSM_FORW:480
	$RT_GSM_480 =
	[
		{name=>'RecordType', bytes=>15},
		{name=>'RecordSequenceNumber', bytes=>8},
		{name=>'CallIdentificationNumber', bytes=>8},
		{name=>'CellIDForFirstCellCalling', bytes=>14},
		{name=>'CellIDForLastCellCalling', bytes=>14},
		{name=>'CellIDForFirstCellCalled', bytes=>14},
		{name=>'CellIDForLastCellCalled', bytes=>14},
		{name=>'ChannelRateInfo', bytes=>2},
		{name=>'MSCIdentification', bytes=>25},
		{name=>'CallingSubscriberIMEI', bytes=>16},
		{name=>'CallingSubscriberIMSI', bytes=>15},
		{name=>'CalledSubscriberIMEI', bytes=>16},
		{name=>'CalledSubscriberIMSI', bytes=>15},
		{name=>'RedirectingIMSI', bytes=>15},
		{name=>'TeleServiceCode', bytes=>2},
		{name=>'BearerServiceCode', bytes=>2},
		{name=>'FaultCode', bytes=>5},
		{name=>'CallingPartyNumber', bytes=>25},
		{name=>'CalledPartyNumber', bytes=>25},
		{name=>'OutgoingRoute', bytes=>14},
		{name=>'IncomingRoute', bytes=>14},
		{name=>'ChargedParty', bytes=>2},
		{name=>'DateForStartofCharge', bytes=>8},
		{name=>'TimeForStartofCharge', bytes=>6},
		{name=>'TimeForTCseizureCalling', bytes=>6},
		{name=>'TimeForTCseizureCalled', bytes=>6},
		{name=>'TimeForStopofCharge', bytes=>6},
		{name=>'ChargeableDuration', bytes=>8},
		{name=>'TariffSwitchInd', bytes=>2},
		{name=>'TariffClass', bytes=>4},
		{name=>'InternalCauseAndLoc', bytes=>4},
		{name=>'DisconnectingParty', bytes=>2},
		{name=>'INMarkingOfMS', bytes=>2},
		{name=>'RelatedCallNumber', bytes=>25},
		{name=>'RedirectionCounter', bytes=>4},
		{name=>'RedirectingNumber', bytes=>25},
		{name=>'OriginalCalledNumber', bytes=>25},
		{name=>'MobileStationRoamingNum', bytes=>25},
		{name=>'ServiceCentreAddress', bytes=>25},
		{name=>'TAC', bytes=>8},
		{name=>'PartialOutputRecNum', bytes=>2},
		{name=>'LastPartialOutput', bytes=>1},
		{name=>'ServiceID', bytes=>6},
	];





}

sub setFormat
{
	my $self = shift;
	my $args = shift;
	
	my $recordType = $args->{record_type};
	my $lineLength = $args->{line_length};
	# combine recordType and lineLength to determine format
	my $lookupKey = $recordType . "_" . $lineLength;
	my $formatKey = $RT_LOOKUP->{$lookupKey};
	
	if (defined ${$formatKey})
	{
		$self->{format} = ${$formatKey};
	}
	else
	{
		print "UNDEFINED FORMAT: [" . $lookupKey . "]\n";
	}
}

sub isMultiFormat
{
	my $self = shift;
	return TRUE;
}	

1;
